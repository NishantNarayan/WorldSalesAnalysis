{"paragraphs":[{"text":"%md\n##Background\n\nThis assignment is based on worldwide sales dataset that has been provided for analysis\n\nObjective: Use Zeppelin and HDFS to ingest data and query it using spark Scala and SQL commands.\n\nData provided: worldsales.csv\n","user":"anonymous","dateUpdated":"2022-02-08T21:31:35+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Background</h2>\n<p>This assignment is based on worldwide sales dataset that has been provided for analysis</p>\n<p>Objective: Use Zeppelin and HDFS to ingest data and query it using spark Scala and SQL commands.</p>\n<p>Data provided: worldsales.csv</p>\n"}]},"apps":[],"jobName":"paragraph_1644351031099_-678700151","id":"20220208-201031_177064810","dateCreated":"2022-02-08T20:10:31+0000","dateStarted":"2022-02-08T21:31:35+0000","dateFinished":"2022-02-08T21:31:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:28806"},{"title":"1. Load data into spark dataframe","text":"%spark2.spark\n\n// Create a worldsales DataFrame from CSV file\nval worldsales = spark.read\n              .option(\"header\", \"true\")                              // Use first line as header\n              .option(\"inferSchema\", \"true\")                         // Infer schema\n              .csv(\"/tmp/worldsales.csv\")                            // Read data","user":"anonymous","dateUpdated":"2022-02-08T20:59:45+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"worldsales: org.apache.spark.sql.DataFrame = [Id: int, Region: string ... 13 more fields]\n"}]},"apps":[],"jobName":"paragraph_1644351261760_2134136117","id":"20220208-201421_1197025301","dateCreated":"2022-02-08T20:14:21+0000","dateStarted":"2022-02-08T20:49:35+0000","dateFinished":"2022-02-08T20:49:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28807"},{"title":"2. Print Schema","text":"%spark2.spark\n\nworldsales.printSchema()\n","user":"anonymous","dateUpdated":"2022-02-08T20:59:53+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- Id: integer (nullable = true)\n |-- Region: string (nullable = true)\n |-- Country: string (nullable = true)\n |-- Item_Type: string (nullable = true)\n |-- Sales_Channel: string (nullable = true)\n |-- Order_Priority: string (nullable = true)\n |-- Order_Date: string (nullable = true)\n |-- Order_ID: integer (nullable = true)\n |-- Ship_Date: string (nullable = true)\n |-- Units_Sold: integer (nullable = true)\n |-- Unit_Price: double (nullable = true)\n |-- Unit_Cost: double (nullable = true)\n |-- Total_Revenue: double (nullable = true)\n |-- Total_Cost: double (nullable = true)\n |-- Total_Profit: double (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1644352526120_-471883381","id":"20220208-203526_1014297725","dateCreated":"2022-02-08T20:35:26+0000","dateStarted":"2022-02-08T20:49:55+0000","dateFinished":"2022-02-08T20:49:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28808"},{"title":"3. Units sold greater than 8000 and unit cost greater than 500","text":"%spark2.spark\n\n\nval filteredWorldsales = worldsales\n                        .filter($\"Units_Sold\" > 8000 && $\"Unit_Cost\" > 500)\n                        \nfilteredWorldsales.show()\n","user":"anonymous","dateUpdated":"2022-02-08T21:07:06+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"filteredWorldsales: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [Id: int, Region: string ... 13 more fields]\n+---+------------------+---------+---------------+-------------+--------------+----------+---------+----------+----------+----------+---------+-------------+----------+------------+\n| Id|            Region|  Country|      Item_Type|Sales_Channel|Order_Priority|Order_Date| Order_ID| Ship_Date|Units_Sold|Unit_Price|Unit_Cost|Total_Revenue|Total_Cost|Total_Profit|\n+---+------------------+---------+---------------+-------------+--------------+----------+---------+----------+----------+----------+---------+-------------+----------+------------+\n| 20|Sub-Saharan Africa|  Senegal|      Household|      Offline|             L| 8/27/2012|247802054|  9/8/2012|      8989|    668.27|   502.54|   6007079.03|4517332.06|  1489746.97|\n| 37|Sub-Saharan Africa|Swaziland|Office Supplies|      Offline|             H| 10/3/2013|405785882|10/22/2013|      9915|    651.21|   524.96|   6456747.15| 5204978.4|  1251768.75|\n+---+------------------+---------+---------------+-------------+--------------+----------+---------+----------+----------+----------+---------+-------------+----------+------------+\n\n"}]},"apps":[],"jobName":"paragraph_1644353394851_84517724","id":"20220208-204954_1896579569","dateCreated":"2022-02-08T20:49:54+0000","dateStarted":"2022-02-08T21:07:07+0000","dateFinished":"2022-02-08T21:07:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28809"},{"title":"Create SQL view","text":"%spark2\n\nworldsales.createOrReplaceTempView(\"salesView\");","user":"anonymous","dateUpdated":"2022-02-08T21:00:10+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1644353663826_-1789226389","id":"20220208-205423_807291457","dateCreated":"2022-02-08T20:54:23+0000","dateStarted":"2022-02-08T21:00:07+0000","dateFinished":"2022-02-08T21:00:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28810"},{"title":"4. Aggregate by region and count","text":"%spark2.sql\n\nSELECT Region, count(*) as CountRegionWise FROM SalesView\nGROUP BY Region\nORDER BY count(*) DESC\n","user":"anonymous","dateUpdated":"2022-02-08T21:02:03+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Region\tCountRegionWise\nSub-Saharan Africa\t15\nEurope\t12\nMiddle East and North Africa\t6\nCentral America and the Caribbean\t6\nAsia\t5\nNorth America\t3\nAustralia and Oceania\t2\n"}]},"apps":[],"jobName":"paragraph_1644353929666_814555477","id":"20220208-205849_2146470440","dateCreated":"2022-02-08T20:58:49+0000","dateStarted":"2022-02-08T21:01:35+0000","dateFinished":"2022-02-08T21:01:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28811"},{"title":"5. Create a dataframe with the group by sales count ","text":"%spark2\n\nval regionworldsales = worldsales.groupBy(\"Region\")\n                                 .count()\n","user":"anonymous","dateUpdated":"2022-02-08T21:10:41+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"regionworldsales: org.apache.spark.sql.DataFrame = [Region: string, count: bigint]\n"}]},"apps":[],"jobName":"paragraph_1644354031997_942062249","id":"20220208-210031_1612618763","dateCreated":"2022-02-08T21:00:31+0000","dateStarted":"2022-02-08T21:08:42+0000","dateFinished":"2022-02-08T21:08:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28812"},{"text":"%spark2\n\nregionworldsales.show()\n","user":"anonymous","dateUpdated":"2022-02-08T21:09:57+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+-----+\n|              Region|count|\n+--------------------+-----+\n|Middle East and N...|    6|\n|Australia and Oce...|    2|\n|              Europe|   12|\n|  Sub-Saharan Africa|   15|\n|Central America a...|    6|\n|       North America|    3|\n|                Asia|    5|\n+--------------------+-----+\n\n"}]},"apps":[],"jobName":"paragraph_1644354511939_-1281328313","id":"20220208-210831_1201903123","dateCreated":"2022-02-08T21:08:31+0000","dateStarted":"2022-02-08T21:09:57+0000","dateFinished":"2022-02-08T21:10:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28813"},{"title":"6. Save as csv","text":"%spark2\n\nregionworldsales.coalesce(1).write.format(\"csv\").option(\"header\",\"true\").save(\"/tmp/regionworldsales.csv\")\n","user":"anonymous","dateUpdated":"2022-02-08T21:13:52+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1644354597083_-1822746636","id":"20220208-210957_169106388","dateCreated":"2022-02-08T21:09:57+0000","dateStarted":"2022-02-08T21:12:41+0000","dateFinished":"2022-02-08T21:12:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28814"},{"title":"7,8 & 9. Create views","text":"%spark2\n\nworldsales.createOrReplaceTempView(\"worldsalesView\");\nregionworldsales.createOrReplaceTempView(\"regionworldsalesView\");","user":"anonymous","dateUpdated":"2022-02-08T21:16:10+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1644354761088_793959637","id":"20220208-211241_546485747","dateCreated":"2022-02-08T21:12:41+0000","dateStarted":"2022-02-08T21:15:37+0000","dateFinished":"2022-02-08T21:15:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28815"},{"title":"10. Line graph","text":"%spark2.sql\n\nSELECT * FROM regionworldsalesView\n\n\n","user":"anonymous","dateUpdated":"2022-02-08T21:17:18+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"lineChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Region\tcount\nMiddle East and North Africa\t6\nAustralia and Oceania\t2\nEurope\t12\nSub-Saharan Africa\t15\nCentral America and the Caribbean\t6\nNorth America\t3\nAsia\t5\n"}]},"apps":[],"jobName":"paragraph_1644354937262_-886766933","id":"20220208-211537_872612383","dateCreated":"2022-02-08T21:15:37+0000","dateStarted":"2022-02-08T21:16:50+0000","dateFinished":"2022-02-08T21:16:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28816"},{"title":"11. Group by region and sum units sold","text":"%spark2.sql\n\nSELECT Region, SUM(units_sold) AS sumOfUnitsSold FROM worldsalesView\nGROUP BY Region\n","user":"anonymous","dateUpdated":"2022-02-08T21:20:04+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Region\tsumOfUnitsSold\nMiddle East and North Africa\t24273\nAustralia and Oceania\t5207\nEurope\t67424\nSub-Saharan Africa\t81582\nCentral America and the Caribbean\t30380\nNorth America\t10607\nAsia\t24189\n"}]},"apps":[],"jobName":"paragraph_1644355010675_-460541773","id":"20220208-211650_584606356","dateCreated":"2022-02-08T21:16:50+0000","dateStarted":"2022-02-08T21:19:03+0000","dateFinished":"2022-02-08T21:19:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28817"},{"title":"12. Group by region and sum total profit","text":"%spark2.sql\n\nSELECT Region, SUM(Total_Profit) AS profitbyRegion FROM worldsalesView\nGROUP BY Region\n","user":"anonymous","dateUpdated":"2022-02-08T21:25:56+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Region\tprofitbyRegion\nMiddle East and North Africa\t1953369.2600000002\nAustralia and Oceania\t325465.98\nEurope\t6015422.9399999995\nSub-Saharan Africa\t6548037.48\nCentral America and the Caribbean\t1570812.06\nNorth America\t246975.83000000002\nAsia\t553680.8999999999\n"}]},"apps":[],"jobName":"paragraph_1644355111000_58823270","id":"20220208-211831_1799198439","dateCreated":"2022-02-08T21:18:31+0000","dateStarted":"2022-02-08T21:22:15+0000","dateFinished":"2022-02-08T21:22:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28818"},{"title":"13. Revenue, Cost, Profit by region","text":"%spark2.sql\n\nSELECT Region, SUM(Total_Profit) AS profit, SUM(Total_Revenue) AS revenue, SUM(Total_Cost) AS cost  FROM worldsalesView\nGROUP BY Region\n","user":"anonymous","dateUpdated":"2022-02-08T21:27:01+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":true,"setting":{"multiBarChart":{}},"commonSetting":{},"keys":[{"name":"Region","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"profit","index":1,"aggr":"sum"},{"name":"revenue","index":2,"aggr":"sum"},{"name":"cost","index":3,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Region\tprofit\trevenue\tcost\nMiddle East and North Africa\t1953369.2600000002\t5202480.26\t3249111.0000000005\nAustralia and Oceania\t325465.98\t801588.06\t476122.08\nEurope\t6015422.9399999995\t2.004863912E7\t1.403321618E7\nSub-Saharan Africa\t6548037.48\t2.8215024759999998E7\t2.166698728E7\nCentral America and the Caribbean\t1570812.06\t6342666.259999999\t4771854.199999999\nNorth America\t246975.83000000002\t645544.05\t398568.22\nAsia\t553680.8999999999\t1425821.1599999997\t872140.26\n"}]},"apps":[],"jobName":"paragraph_1644355261416_989913964","id":"20220208-212101_465943267","dateCreated":"2022-02-08T21:21:01+0000","dateStarted":"2022-02-08T21:23:58+0000","dateFinished":"2022-02-08T21:24:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28819"},{"title":"14. Pie chart by profit percentage region-wise","text":"%spark2.sql\n\nSELECT Region, Avg(Total_Profit) AS averageProfit FROM worldsalesView\nGROUP BY Region\n","user":"anonymous","dateUpdated":"2022-02-08T21:38:40+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Region\taverageProfit\nMiddle East and North Africa\t325561.5433333334\nAustralia and Oceania\t162732.99\nEurope\t501285.24499999994\nSub-Saharan Africa\t436535.83200000005\nCentral America and the Caribbean\t261802.01\nNorth America\t82325.27666666667\nAsia\t110736.17999999998\n"}]},"apps":[],"jobName":"paragraph_1644355438920_1960094159","id":"20220208-212358_178974206","dateCreated":"2022-02-08T21:23:58+0000","dateStarted":"2022-02-08T21:29:00+0000","dateFinished":"2022-02-08T21:29:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28820"},{"text":"%spark2\n\nworldsales.groupBy(\"Region\").count().show()\n","user":"anonymous","dateUpdated":"2022-02-08T21:47:18+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+-----+\n|              Region|count|\n+--------------------+-----+\n|Middle East and N...|    6|\n|Australia and Oce...|    2|\n|              Europe|   12|\n|  Sub-Saharan Africa|   15|\n|Central America a...|    6|\n|       North America|    3|\n|                Asia|    5|\n+--------------------+-----+\n\n"}]},"apps":[],"jobName":"paragraph_1644355740902_-1045719135","id":"20220208-212900_523855982","dateCreated":"2022-02-08T21:29:00+0000","dateStarted":"2022-02-08T21:47:18+0000","dateFinished":"2022-02-08T21:47:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28821"},{"text":"%spark2\n","user":"anonymous","dateUpdated":"2022-02-08T21:47:06+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1644356826858_1474521313","id":"20220208-214706_973987904","dateCreated":"2022-02-08T21:47:06+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:28822"}],"name":"In class assignment 1","id":"2GX97SAA5","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}